Skipping import of cpp extensions due to incompatible torch version 2.10.0a0+rocm7.11.0a20251210 for torchao version 0.14.1             Please see https://github.com/pytorch/ao/issues/2919 for more info
WARNING 12-19 17:09:03 [attention.py:82] Using VLLM_V1_USE_PREFILL_DECODE_ATTENTION environment variable is deprecated and will be removed in v0.14.0 or v1.0.0, whichever is soonest. Please use --attention-config.use_prefill_decode_attention command line argument or AttentionConfig(use_prefill_decode_attention=...) config field instead.
[0;36m(APIServer pid=75372)[0;0m INFO 12-19 17:09:03 [api_server.py:1351] vLLM API server version 0.13.0rc2.dev112+g763963aa7.d20251213
[0;36m(APIServer pid=75372)[0;0m INFO 12-19 17:09:03 [utils.py:253] non-default args: {'model_tag': 'RedHatAI/Qwen3-14B-FP8-dynamic', 'host': '127.0.0.1', 'model': 'RedHatAI/Qwen3-14B-FP8-dynamic', 'trust_remote_code': True, 'max_model_len': 32000, 'tensor_parallel_size': 2, 'gpu_memory_utilization': 0.98, 'max_num_seqs': 64}
[0;36m(APIServer pid=75372)[0;0m The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(APIServer pid=75372)[0;0m INFO 12-19 17:09:08 [model.py:514] Resolved architecture: Qwen3ForCausalLM
[0;36m(APIServer pid=75372)[0;0m INFO 12-19 17:09:08 [model.py:1636] Using max model len 32000
[0;36m(APIServer pid=75372)[0;0m INFO 12-19 17:09:08 [scheduler.py:228] Chunked prefill is enabled with max_num_batched_tokens=2048.
Skipping import of cpp extensions due to incompatible torch version 2.10.0a0+rocm7.11.0a20251210 for torchao version 0.14.1             Please see https://github.com/pytorch/ao/issues/2919 for more info
[0;36m(EngineCore_DP0 pid=75534)[0;0m INFO 12-19 17:09:12 [core.py:93] Initializing a V1 LLM engine (v0.13.0rc2.dev112+g763963aa7.d20251213) with config: model='RedHatAI/Qwen3-14B-FP8-dynamic', speculative_config=None, tokenizer='RedHatAI/Qwen3-14B-FP8-dynamic', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32000, download_dir=None, load_format=auto, tensor_parallel_size=2, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=True, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=RedHatAI/Qwen3-14B-FP8-dynamic, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [2048], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 128, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
[0;36m(EngineCore_DP0 pid=75534)[0;0m WARNING 12-19 17:09:12 [multiproc_executor.py:884] Reducing Torch parallelism from 24 threads to 1 to avoid unnecessary CPU contention. Set OMP_NUM_THREADS in the external environment to tune this value as needed.
Skipping import of cpp extensions due to incompatible torch version 2.10.0a0+rocm7.11.0a20251210 for torchao version 0.14.1             Please see https://github.com/pytorch/ao/issues/2919 for more info
Skipping import of cpp extensions due to incompatible torch version 2.10.0a0+rocm7.11.0a20251210 for torchao version 0.14.1             Please see https://github.com/pytorch/ao/issues/2919 for more info
INFO 12-19 17:09:15 [parallel_state.py:1203] world_size=2 rank=1 local_rank=1 distributed_init_method=tcp://127.0.0.1:35477 backend=nccl
INFO 12-19 17:09:15 [parallel_state.py:1203] world_size=2 rank=0 local_rank=0 distributed_init_method=tcp://127.0.0.1:35477 backend=nccl
INFO 12-19 17:09:16 [pynccl.py:111] vLLM is using nccl==2.27.3
INFO 12-19 17:09:16 [parallel_state.py:1411] rank 0 in world size 2 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
INFO 12-19 17:09:16 [parallel_state.py:1411] rank 1 in world size 2 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 1, EP rank 1
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:17 [gpu_model_runner.py:3562] Starting to load model RedHatAI/Qwen3-14B-FP8-dynamic...
[0;36m(Worker_TP1 pid=75617)[0;0m INFO 12-19 17:09:17 [rocm.py:306] Using Rocm Attention backend on V1 engine.
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:17 [rocm.py:306] Using Rocm Attention backend on V1 engine.
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  2.57it/s]
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.02it/s]
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.14s/it]
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.19s/it]
[0;36m(Worker_TP0 pid=75616)[0;0m Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.09s/it]
[0;36m(Worker_TP0 pid=75616)[0;0m 
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:22 [default_loader.py:308] Loading weights took 4.43 seconds
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:23 [gpu_model_runner.py:3659] Model loading took 7.8555 GiB memory and 5.221202 seconds
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:28 [backends.py:634] Using cache directory: /home/kyuz0/.cache/vllm/torch_compile_cache/8760cb82b9/rank_0_0/backbone for vLLM's torch.compile
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:28 [backends.py:694] Dynamo bytecode transform time: 5.45 s
[0;36m(Worker_TP1 pid=75617)[0;0m INFO 12-19 17:09:31 [backends.py:261] Cache the graph of compile range (1, 2048) for later use
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:31 [backends.py:261] Cache the graph of compile range (1, 2048) for later use
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:36 [backends.py:278] Compiling a graph for compile range (1, 2048) takes 4.77 s
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:36 [monitor.py:34] torch.compile takes 10.22 s in total
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:39 [gpu_worker.py:375] Available KV cache memory: 22.49 GiB
[0;36m(EngineCore_DP0 pid=75534)[0;0m INFO 12-19 17:09:39 [kv_cache_utils.py:1291] GPU KV cache size: 294,752 tokens
[0;36m(EngineCore_DP0 pid=75534)[0;0m INFO 12-19 17:09:39 [kv_cache_utils.py:1296] Maximum concurrency for 32,000 tokens per request: 9.21x
[0;36m(Worker_TP0 pid=75616)[0;0m Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|â–Œ         | 1/19 [00:00<00:08,  2.07it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|â–ˆ         | 2/19 [00:00<00:07,  2.15it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|â–ˆâ–Œ        | 3/19 [00:01<00:07,  2.27it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|â–ˆâ–ˆ        | 4/19 [00:01<00:06,  2.32it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|â–ˆâ–ˆâ–‹       | 5/19 [00:02<00:05,  2.36it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:02<00:05,  2.39it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:02<00:04,  2.42it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:03<00:04,  2.44it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:03<00:04,  2.47it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:04<00:03,  2.48it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:04<00:03,  2.49it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:04<00:02,  2.50it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:05<00:02,  2.50it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:05<00:02,  2.50it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:06<00:01,  2.49it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:06<00:01,  2.49it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:06<00:00,  2.49it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:07<00:00,  2.48it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:07<00:00,  2.51it/s]Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:07<00:00,  2.44it/s]
[0;36m(Worker_TP0 pid=75616)[0;0m Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]Capturing CUDA graphs (decode, FULL):   9%|â–‰         | 1/11 [00:00<00:06,  1.63it/s]Capturing CUDA graphs (decode, FULL):  18%|â–ˆâ–Š        | 2/11 [00:01<00:04,  1.99it/s]Capturing CUDA graphs (decode, FULL):  27%|â–ˆâ–ˆâ–‹       | 3/11 [00:01<00:03,  2.20it/s]Capturing CUDA graphs (decode, FULL):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 4/11 [00:01<00:03,  2.30it/s]Capturing CUDA graphs (decode, FULL):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 5/11 [00:02<00:02,  2.36it/s]Capturing CUDA graphs (decode, FULL):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 6/11 [00:02<00:02,  2.40it/s]Capturing CUDA graphs (decode, FULL):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 7/11 [00:03<00:01,  2.44it/s]Capturing CUDA graphs (decode, FULL):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 8/11 [00:03<00:01,  2.47it/s]Capturing CUDA graphs (decode, FULL):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 9/11 [00:03<00:00,  2.50it/s]Capturing CUDA graphs (decode, FULL):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 10/11 [00:04<00:00,  2.51it/s]Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:04<00:00,  2.53it/s]Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:04<00:00,  2.39it/s]
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:52 [gpu_model_runner.py:4610] Graph capturing finished in 13 secs, took 0.66 GiB
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] WorkerProc hit an exception.
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4302, in _dummy_sampler_run
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampler_output = self.sampler(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits=logits, sampling_metadata=dummy_metadata
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 96, in forward
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampled, processed_logprobs = self.sample(logits, sampling_metadata)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 187, in sample
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     random_sampled, processed_logprobs = self.topk_topp_sampler(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                          ~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits,
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<2 lines>...
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         sampling_metadata.top_p,
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 104, in forward_native
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits = self.apply_top_k_top_p(logits, k, p)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 258, in apply_top_k_top_p
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits_sort, logits_idx = logits.sort(dim=-1, descending=False)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] torch.OutOfMemoryError: HIP out of memory. Tried to allocate 76.00 MiB. GPU 1 has a total capacity of 31.86 GiB of which 0 bytes is free. Of the allocated memory 30.75 GiB is allocated by PyTorch, with 68.00 MiB allocated in private pools (e.g., HIP Graphs), and 167.43 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] The above exception was the direct cause of the following exception:
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 821, in worker_busy_loop
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     output = func(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 538, in compile_or_warm_up_model
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     self.model_runner._dummy_sampler_run(hidden_states=last_hidden_states)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/utils/_contextlib.py", line 124, in decorate_context
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return func(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4307, in _dummy_sampler_run
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     raise RuntimeError(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<4 lines>...
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ) from e
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] RuntimeError: CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4302, in _dummy_sampler_run
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampler_output = self.sampler(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits=logits, sampling_metadata=dummy_metadata
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 96, in forward
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampled, processed_logprobs = self.sample(logits, sampling_metadata)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 187, in sample
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     random_sampled, processed_logprobs = self.topk_topp_sampler(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                          ~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits,
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<2 lines>...
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         sampling_metadata.top_p,
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 104, in forward_native
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits = self.apply_top_k_top_p(logits, k, p)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 258, in apply_top_k_top_p
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits_sort, logits_idx = logits.sort(dim=-1, descending=False)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] torch.OutOfMemoryError: HIP out of memory. Tried to allocate 76.00 MiB. GPU 1 has a total capacity of 31.86 GiB of which 0 bytes is free. Of the allocated memory 30.75 GiB is allocated by PyTorch, with 68.00 MiB allocated in private pools (e.g., HIP Graphs), and 167.43 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] The above exception was the direct cause of the following exception:
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 821, in worker_busy_loop
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     output = func(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 538, in compile_or_warm_up_model
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     self.model_runner._dummy_sampler_run(hidden_states=last_hidden_states)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/utils/_contextlib.py", line 124, in decorate_context
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return func(*args, **kwargs)
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4307, in _dummy_sampler_run
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     raise RuntimeError(
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<4 lines>...
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ) from e
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] RuntimeError: CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.
[0;36m(Worker_TP1 pid=75617)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] WorkerProc hit an exception.
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4302, in _dummy_sampler_run
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampler_output = self.sampler(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits=logits, sampling_metadata=dummy_metadata
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 96, in forward
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampled, processed_logprobs = self.sample(logits, sampling_metadata)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 187, in sample
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     random_sampled, processed_logprobs = self.topk_topp_sampler(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                          ~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits,
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<2 lines>...
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         sampling_metadata.top_p,
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 104, in forward_native
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits = self.apply_top_k_top_p(logits, k, p)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 258, in apply_top_k_top_p
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits_sort, logits_idx = logits.sort(dim=-1, descending=False)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] torch.OutOfMemoryError: HIP out of memory. Tried to allocate 38.00 MiB. GPU 0 has a total capacity of 31.86 GiB of which 0 bytes is free. Of the allocated memory 30.83 GiB is allocated by PyTorch, with 68.00 MiB allocated in private pools (e.g., HIP Graphs), and 169.24 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] The above exception was the direct cause of the following exception:
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 821, in worker_busy_loop
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     output = func(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 538, in compile_or_warm_up_model
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     self.model_runner._dummy_sampler_run(hidden_states=last_hidden_states)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/utils/_contextlib.py", line 124, in decorate_context
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return func(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4307, in _dummy_sampler_run
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     raise RuntimeError(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<4 lines>...
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ) from e
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] RuntimeError: CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4302, in _dummy_sampler_run
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampler_output = self.sampler(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits=logits, sampling_metadata=dummy_metadata
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 96, in forward
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     sampled, processed_logprobs = self.sample(logits, sampling_metadata)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                   ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/sampler.py", line 187, in sample
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     random_sampled, processed_logprobs = self.topk_topp_sampler(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                                          ~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         logits,
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<2 lines>...
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         sampling_metadata.top_p,
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     )
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1776, in _wrapped_call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return self._call_impl(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/nn/modules/module.py", line 1787, in _call_impl
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return forward_call(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 104, in forward_native
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits = self.apply_top_k_top_p(logits, k, p)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/sample/ops/topk_topp_sampler.py", line 258, in apply_top_k_top_p
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     logits_sort, logits_idx = logits.sort(dim=-1, descending=False)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]                               ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] torch.OutOfMemoryError: HIP out of memory. Tried to allocate 38.00 MiB. GPU 0 has a total capacity of 31.86 GiB of which 0 bytes is free. Of the allocated memory 30.83 GiB is allocated by PyTorch, with 68.00 MiB allocated in private pools (e.g., HIP Graphs), and 169.24 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] The above exception was the direct cause of the following exception:
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] Traceback (most recent call last):
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 821, in worker_busy_loop
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     output = func(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_worker.py", line 538, in compile_or_warm_up_model
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     self.model_runner._dummy_sampler_run(hidden_states=last_hidden_states)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/torch/utils/_contextlib.py", line 124, in decorate_context
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     return func(*args, **kwargs)
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4307, in _dummy_sampler_run
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     raise RuntimeError(
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ...<4 lines>...
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826]     ) from e
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] RuntimeError: CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.
[0;36m(Worker_TP0 pid=75616)[0;0m ERROR 12-19 17:09:52 [multiproc_executor.py:826] 
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866] EngineCore failed to start.
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 857, in run_engine_core
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 637, in __init__
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     super().__init__(
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]                                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]         vllm_config
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]         ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 256, in _initialize_kv_caches
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     self.model_executor.initialize_from_config(kv_cache_configs)
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/abstract.py", line 116, in initialize_from_config
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     self.collective_rpc("compile_or_warm_up_model")
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 361, in collective_rpc
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     return aggregate(get_response())
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]                      ~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 344, in get_response
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     raise RuntimeError(
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866]     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m ERROR 12-19 17:09:52 [core.py:866] RuntimeError: Worker failed with error 'CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.', please check the stack trace above for the root cause
[0;36m(EngineCore_DP0 pid=75534)[0;0m Process EngineCore_DP0:
[0;36m(EngineCore_DP0 pid=75534)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/usr/lib64/python3.13/multiprocessing/process.py", line 313, in _bootstrap
[0;36m(EngineCore_DP0 pid=75534)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/usr/lib64/python3.13/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=75534)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 870, in run_engine_core
[0;36m(EngineCore_DP0 pid=75534)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 857, in run_engine_core
[0;36m(EngineCore_DP0 pid=75534)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 637, in __init__
[0;36m(EngineCore_DP0 pid=75534)[0;0m     super().__init__(
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=75534)[0;0m         vllm_config, executor_class, log_stats, executor_fail_callback
[0;36m(EngineCore_DP0 pid=75534)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[0;36m(EngineCore_DP0 pid=75534)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[0;36m(EngineCore_DP0 pid=75534)[0;0m                                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(EngineCore_DP0 pid=75534)[0;0m         vllm_config
[0;36m(EngineCore_DP0 pid=75534)[0;0m         ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core.py", line 256, in _initialize_kv_caches
[0;36m(EngineCore_DP0 pid=75534)[0;0m     self.model_executor.initialize_from_config(kv_cache_configs)
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/abstract.py", line 116, in initialize_from_config
[0;36m(EngineCore_DP0 pid=75534)[0;0m     self.collective_rpc("compile_or_warm_up_model")
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 361, in collective_rpc
[0;36m(EngineCore_DP0 pid=75534)[0;0m     return aggregate(get_response())
[0;36m(EngineCore_DP0 pid=75534)[0;0m                      ~~~~~~~~~~~~^^
[0;36m(EngineCore_DP0 pid=75534)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/executor/multiproc_executor.py", line 344, in get_response
[0;36m(EngineCore_DP0 pid=75534)[0;0m     raise RuntimeError(
[0;36m(EngineCore_DP0 pid=75534)[0;0m     ...<2 lines>...
[0;36m(EngineCore_DP0 pid=75534)[0;0m     )
[0;36m(EngineCore_DP0 pid=75534)[0;0m RuntimeError: Worker failed with error 'CUDA out of memory occurred when warming up sampler with 64 dummy requests. Please try lowering `max_num_seqs` or `gpu_memory_utilization` when initializing the engine.', please check the stack trace above for the root cause
[0;36m(Worker_TP1 pid=75617)[0;0m INFO 12-19 17:09:52 [multiproc_executor.py:711] Parent process exited, terminating worker
[0;36m(Worker_TP0 pid=75616)[0;0m INFO 12-19 17:09:52 [multiproc_executor.py:711] Parent process exited, terminating worker
[0;36m(APIServer pid=75372)[0;0m Traceback (most recent call last):
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/bin/vllm", line 7, in <module>
[0;36m(APIServer pid=75372)[0;0m     sys.exit(main())
[0;36m(APIServer pid=75372)[0;0m              ~~~~^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/cli/main.py", line 73, in main
[0;36m(APIServer pid=75372)[0;0m     args.dispatch_function(args)
[0;36m(APIServer pid=75372)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/cli/serve.py", line 60, in cmd
[0;36m(APIServer pid=75372)[0;0m     uvloop.run(run_server(args))
[0;36m(APIServer pid=75372)[0;0m     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/uvloop/__init__.py", line 96, in run
[0;36m(APIServer pid=75372)[0;0m     return __asyncio.run(
[0;36m(APIServer pid=75372)[0;0m            ~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         wrapper(),
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ...<2 lines>...
[0;36m(APIServer pid=75372)[0;0m         **run_kwargs
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/usr/lib64/python3.13/asyncio/runners.py", line 195, in run
[0;36m(APIServer pid=75372)[0;0m     return runner.run(main)
[0;36m(APIServer pid=75372)[0;0m            ~~~~~~~~~~^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/usr/lib64/python3.13/asyncio/runners.py", line 118, in run
[0;36m(APIServer pid=75372)[0;0m     return self._loop.run_until_complete(task)
[0;36m(APIServer pid=75372)[0;0m            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/uvloop/__init__.py", line 48, in wrapper
[0;36m(APIServer pid=75372)[0;0m     return await main
[0;36m(APIServer pid=75372)[0;0m            ^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/openai/api_server.py", line 1398, in run_server
[0;36m(APIServer pid=75372)[0;0m     await run_server_worker(listen_address, sock, args, **uvicorn_kwargs)
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/openai/api_server.py", line 1417, in run_server_worker
[0;36m(APIServer pid=75372)[0;0m     async with build_async_engine_client(
[0;36m(APIServer pid=75372)[0;0m                ~~~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         args,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^
[0;36m(APIServer pid=75372)[0;0m         client_config=client_config,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ) as engine_client:
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/usr/lib64/python3.13/contextlib.py", line 214, in __aenter__
[0;36m(APIServer pid=75372)[0;0m     return await anext(self.gen)
[0;36m(APIServer pid=75372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/openai/api_server.py", line 172, in build_async_engine_client
[0;36m(APIServer pid=75372)[0;0m     async with build_async_engine_client_from_engine_args(
[0;36m(APIServer pid=75372)[0;0m                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         engine_args,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ...<2 lines>...
[0;36m(APIServer pid=75372)[0;0m         client_config=client_config,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ) as engine:
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/usr/lib64/python3.13/contextlib.py", line 214, in __aenter__
[0;36m(APIServer pid=75372)[0;0m     return await anext(self.gen)
[0;36m(APIServer pid=75372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/entrypoints/openai/api_server.py", line 213, in build_async_engine_client_from_engine_args
[0;36m(APIServer pid=75372)[0;0m     async_llm = AsyncLLM.from_vllm_config(
[0;36m(APIServer pid=75372)[0;0m         vllm_config=vllm_config,
[0;36m(APIServer pid=75372)[0;0m     ...<6 lines>...
[0;36m(APIServer pid=75372)[0;0m         client_index=client_index,
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/async_llm.py", line 215, in from_vllm_config
[0;36m(APIServer pid=75372)[0;0m     return cls(
[0;36m(APIServer pid=75372)[0;0m         vllm_config=vllm_config,
[0;36m(APIServer pid=75372)[0;0m     ...<9 lines>...
[0;36m(APIServer pid=75372)[0;0m         client_index=client_index,
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/async_llm.py", line 134, in __init__
[0;36m(APIServer pid=75372)[0;0m     self.engine_core = EngineCoreClient.make_async_mp_client(
[0;36m(APIServer pid=75372)[0;0m                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         vllm_config=vllm_config,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ...<4 lines>...
[0;36m(APIServer pid=75372)[0;0m         client_index=client_index,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core_client.py", line 121, in make_async_mp_client
[0;36m(APIServer pid=75372)[0;0m     return AsyncMPClient(*client_args)
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core_client.py", line 820, in __init__
[0;36m(APIServer pid=75372)[0;0m     super().__init__(
[0;36m(APIServer pid=75372)[0;0m     ~~~~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         asyncio_mode=True,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ...<3 lines>...
[0;36m(APIServer pid=75372)[0;0m         client_addresses=client_addresses,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/core_client.py", line 477, in __init__
[0;36m(APIServer pid=75372)[0;0m     with launch_core_engines(vllm_config, executor_class, log_stats) as (
[0;36m(APIServer pid=75372)[0;0m          ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/usr/lib64/python3.13/contextlib.py", line 148, in __exit__
[0;36m(APIServer pid=75372)[0;0m     next(self.gen)
[0;36m(APIServer pid=75372)[0;0m     ~~~~^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/utils.py", line 903, in launch_core_engines
[0;36m(APIServer pid=75372)[0;0m     wait_for_engine_startup(
[0;36m(APIServer pid=75372)[0;0m     ~~~~~~~~~~~~~~~~~~~~~~~^
[0;36m(APIServer pid=75372)[0;0m         handshake_socket,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     ...<5 lines>...
[0;36m(APIServer pid=75372)[0;0m         coordinator.proc if coordinator else None,
[0;36m(APIServer pid=75372)[0;0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m     ^
[0;36m(APIServer pid=75372)[0;0m   File "/opt/venv/lib64/python3.13/site-packages/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
[0;36m(APIServer pid=75372)[0;0m     raise RuntimeError(
[0;36m(APIServer pid=75372)[0;0m     ...<3 lines>...
[0;36m(APIServer pid=75372)[0;0m     )
[0;36m(APIServer pid=75372)[0;0m RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
